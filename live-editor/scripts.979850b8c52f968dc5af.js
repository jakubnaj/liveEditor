Array.prototype.contains=function(e){return this.indexOf(e)>-1},new function(){var e=this;function t(e,t,n){return e>=t&&e<=n}this.root_id="tinymce",this.preventdelete_class="mceNonEditable",this.nextElement=function(t){for(var n=$(t),r=n.next();0==r.length;){if((n=n.parent()).attr("id")==e.root_id)return!1;r=n.next()}return r},this.prevElement=function(t){for(var n=$(t),r=n.prev();0==r.length;){if((n=n.parent()).attr("id")==e.root_id)return!1;r=n.prev()}return r},this.keyWillDelete=function(e){var n=e.keyCode;return e.ctrlKey?"x"==e.key||[8,46].contains(n):[8,9,13,46].contains(n)||t(n,48,57)||t(n,65,90)||t(n,96,111)||t(n,186,192)||t(n,219,222)},this.cancelKey=function(e){return e.preventDefault(),e.stopPropagation(),!1},this.check=function(t){return $(t).hasClass(e.preventdelete_class)},this.checkParents=function(t){return!t||$(t).parents("."+e.preventdelete_class).length>0},this.checkChildren=function(t){return!!t&&$(t).find("."+e.preventdelete_class).length>0},this.logElem=function(e){var t={};["innerHTML","nodeName","nodeType","nextSibling","previousSibling","outerHTML","parentElement","data"].forEach((function(n){t[n]=e[n]}))},tinymce.PluginManager.add("preventdelete",(function(t,n){t.on("keydown",(function(t){if(!e.keyWillDelete(t))return!0;var n=tinymce.activeEditor.selection.getNode();if(e.check(n)||e.checkChildren(n))return e.cancelKey(t);var r=tinymce.activeEditor.selection.getRng();e.logElem(r.startContainer);for(var i,a=8==t.keyCode,c=46==t.keyCode,o=r.startContainer;!i&&o&&(i=i||e.check(o),r.endContainer!==o);o=o.nextSibling);var f=r.endContainer;if(f&&0===r.endOffset&&(e.check(f)||e.checkChildren(f)))return e.cancelKey(t);if(i)return e.cancelKey(t);var l=r.endContainer.data||"",s=r.startContainer.data&&65279===r.startContainer.data.charCodeAt(0),d=c&&r.endContainer.data&&r.endOffset<l.length&&!(s&&1===l.length),u=a&&r.startContainer.data&&r.startOffset>s,h=r.startOffset===r.endOffset,v=t.ctrlKey&&(a||c)&&!function(e,t,n){for(var r=!1,i=!1,a=(n=!1!==n)?t-1:t;n?a>0:a<e.length;n?a--:a++){var c=[160,32].contains(e.charCodeAt(a));if(!i&&c?i=!0:r||c||(r=!0),i&&r)return!0}return!1}(r.startContainer.data,r.startOffset,a);if((d||u)&&!v)return!0;if(!v){if(c&&h&&r.startOffset+1<r.endContainer.childElementCount)return!e.check(r.endContainer.childNodes[r.startOffset+1])||e.cancelKey(t);if(r.startOffset!==r.endOffset)return!i||e.cancelKey(t)}if(c){var y=e.nextElement(r.endContainer);if(!y)return e.cancelKey(t);if(e.check(y)||e.checkChildren(y))return e.cancelKey(t)}if(a){var C=e.prevElement(r.startContainer);if(e.check(C))return e.cancelKey(t)}}))}))};